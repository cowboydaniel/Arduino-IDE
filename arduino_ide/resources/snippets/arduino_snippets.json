{
  "Basic Structure": [
    {
      "name": "Basic Setup and Loop",
      "prefix": "setup",
      "description": "Complete Arduino sketch structure with setup() and loop()",
      "body": [
        "void setup() {",
        "  // Initialize serial communication",
        "  Serial.begin(9600);",
        "  ",
        "  // Setup code here",
        "  $0",
        "}",
        "",
        "void loop() {",
        "  // Main code here",
        "  ",
        "}"
      ]
    },
    {
      "name": "Function Template",
      "prefix": "func",
      "description": "Function definition template",
      "body": [
        "${1:returnType} ${2:functionName}(${3:parameters}) {",
        "  $0",
        "}"
      ]
    }
  ],
  "Digital I/O": [
    {
      "name": "Button Debouncing",
      "prefix": "debounce",
      "description": "Debounced button reading with state tracking",
      "body": [
        "const int BUTTON_PIN = ${1:2};",
        "const unsigned long DEBOUNCE_DELAY = 50;",
        "",
        "int buttonState;",
        "int lastButtonState = LOW;",
        "unsigned long lastDebounceTime = 0;",
        "",
        "void setup() {",
        "  pinMode(BUTTON_PIN, INPUT_PULLUP);",
        "  Serial.begin(9600);",
        "}",
        "",
        "void loop() {",
        "  int reading = digitalRead(BUTTON_PIN);",
        "  ",
        "  if (reading != lastButtonState) {",
        "    lastDebounceTime = millis();",
        "  }",
        "  ",
        "  if ((millis() - lastDebounceTime) > DEBOUNCE_DELAY) {",
        "    if (reading != buttonState) {",
        "      buttonState = reading;",
        "      ",
        "      if (buttonState == LOW) {",
        "        // Button pressed",
        "        $0",
        "      }",
        "    }",
        "  }",
        "  ",
        "  lastButtonState = reading;",
        "}"
      ]
    },
    {
      "name": "LED Blink Without Delay",
      "prefix": "blink",
      "description": "Non-blocking LED blinking using millis()",
      "body": [
        "const int LED_PIN = ${1:LED_BUILTIN};",
        "const unsigned long BLINK_INTERVAL = ${2:1000};",
        "",
        "unsigned long previousMillis = 0;",
        "int ledState = LOW;",
        "",
        "void setup() {",
        "  pinMode(LED_PIN, OUTPUT);",
        "}",
        "",
        "void loop() {",
        "  unsigned long currentMillis = millis();",
        "  ",
        "  if (currentMillis - previousMillis >= BLINK_INTERVAL) {",
        "    previousMillis = currentMillis;",
        "    ledState = !ledState;",
        "    digitalWrite(LED_PIN, ledState);",
        "  }",
        "  $0",
        "}"
      ]
    }
  ],
  "Analog I/O": [
    {
      "name": "PWM Fade",
      "prefix": "fade",
      "description": "Fade an LED using PWM",
      "body": [
        "const int LED_PIN = ${1:9};",
        "int brightness = 0;",
        "int fadeAmount = 5;",
        "",
        "void setup() {",
        "  pinMode(LED_PIN, OUTPUT);",
        "}",
        "",
        "void loop() {",
        "  analogWrite(LED_PIN, brightness);",
        "  brightness += fadeAmount;",
        "  ",
        "  if (brightness <= 0 || brightness >= 255) {",
        "    fadeAmount = -fadeAmount;",
        "  }",
        "  ",
        "  delay(30);",
        "  $0",
        "}"
      ]
    },
    {
      "name": "Analog Sensor Reading",
      "prefix": "sensor",
      "description": "Read analog sensor with averaging",
      "body": [
        "const int SENSOR_PIN = ${1:A0};",
        "const int NUM_READINGS = 10;",
        "",
        "int readings[NUM_READINGS];",
        "int readIndex = 0;",
        "int total = 0;",
        "int average = 0;",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "  for (int i = 0; i < NUM_READINGS; i++) {",
        "    readings[i] = 0;",
        "  }",
        "}",
        "",
        "void loop() {",
        "  total -= readings[readIndex];",
        "  readings[readIndex] = analogRead(SENSOR_PIN);",
        "  total += readings[readIndex];",
        "  readIndex = (readIndex + 1) % NUM_READINGS;",
        "  ",
        "  average = total / NUM_READINGS;",
        "  Serial.println(average);",
        "  $0",
        "  ",
        "  delay(10);",
        "}"
      ]
    }
  ],
  "Serial Communication": [
    {
      "name": "Serial Command Parser",
      "prefix": "serial",
      "description": "Parse commands from Serial input",
      "body": [
        "String inputString = \"\";",
        "bool stringComplete = false;",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "  inputString.reserve(200);",
        "  Serial.println(\"Ready. Enter commands:\");",
        "}",
        "",
        "void loop() {",
        "  if (stringComplete) {",
        "    // Process command",
        "    inputString.trim();",
        "    ",
        "    if (inputString == \"${1:ON}\") {",
        "      // Handle ON command",
        "      $0",
        "    } else if (inputString == \"OFF\") {",
        "      // Handle OFF command",
        "      ",
        "    }",
        "    ",
        "    inputString = \"\";",
        "    stringComplete = false;",
        "  }",
        "}",
        "",
        "void serialEvent() {",
        "  while (Serial.available()) {",
        "    char inChar = (char)Serial.read();",
        "    if (inChar == '\\n') {",
        "      stringComplete = true;",
        "    } else {",
        "      inputString += inChar;",
        "    }",
        "  }",
        "}"
      ]
    }
  ],
  "I2C Communication": [
    {
      "name": "I2C Scanner",
      "prefix": "i2c",
      "description": "Scan for I2C devices",
      "body": [
        "#include <Wire.h>",
        "",
        "void setup() {",
        "  Wire.begin();",
        "  Serial.begin(9600);",
        "  Serial.println(\"I2C Scanner\");",
        "}",
        "",
        "void loop() {",
        "  byte error, address;",
        "  int nDevices = 0;",
        "  ",
        "  Serial.println(\"Scanning...\");",
        "  ",
        "  for(address = 1; address < 127; address++) {",
        "    Wire.beginTransmission(address);",
        "    error = Wire.endTransmission();",
        "    ",
        "    if (error == 0) {",
        "      Serial.print(\"I2C device found at address 0x\");",
        "      if (address < 16) Serial.print(\"0\");",
        "      Serial.println(address, HEX);",
        "      nDevices++;",
        "    }",
        "  }",
        "  ",
        "  if (nDevices == 0) {",
        "    Serial.println(\"No I2C devices found\");",
        "  }",
        "  ",
        "  delay(5000);",
        "  $0",
        "}"
      ]
    }
  ],
  "State Machines": [
    {
      "name": "Simple State Machine",
      "prefix": "state",
      "description": "Basic state machine template",
      "body": [
        "enum State {",
        "  ${1:STATE_IDLE},",
        "  ${2:STATE_RUNNING},",
        "  ${3:STATE_DONE}",
        "};",
        "",
        "State currentState = ${1:STATE_IDLE};",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "}",
        "",
        "void loop() {",
        "  switch(currentState) {",
        "    case ${1:STATE_IDLE}:",
        "      // Handle idle state",
        "      $0",
        "      break;",
        "      ",
        "    case ${2:STATE_RUNNING}:",
        "      // Handle running state",
        "      break;",
        "      ",
        "    case ${3:STATE_DONE}:",
        "      // Handle done state",
        "      break;",
        "  }",
        "}"
      ]
    }
  ],
  "Timing": [
    {
      "name": "Multi-Timer",
      "prefix": "timer",
      "description": "Multiple non-blocking timers",
      "body": [
        "unsigned long timer1 = 0;",
        "unsigned long timer2 = 0;",
        "const unsigned long INTERVAL1 = ${1:1000};",
        "const unsigned long INTERVAL2 = ${2:2000};",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "}",
        "",
        "void loop() {",
        "  unsigned long now = millis();",
        "  ",
        "  // Timer 1",
        "  if (now - timer1 >= INTERVAL1) {",
        "    timer1 = now;",
        "    // Timer 1 action",
        "    $0",
        "  }",
        "  ",
        "  // Timer 2",
        "  if (now - timer2 >= INTERVAL2) {",
        "    timer2 = now;",
        "    // Timer 2 action",
        "    ",
        "  }",
        "}"
      ]
    }
  ],
  "Interrupts": [
    {
      "name": "External Interrupt",
      "prefix": "interrupt",
      "description": "Setup external interrupt handler",
      "body": [
        "const int INTERRUPT_PIN = ${1:2};",
        "volatile bool interruptFlag = false;",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "  pinMode(INTERRUPT_PIN, INPUT_PULLUP);",
        "  attachInterrupt(digitalPinToInterrupt(INTERRUPT_PIN), ${2:handleInterrupt}, ${3:FALLING});",
        "}",
        "",
        "void loop() {",
        "  if (interruptFlag) {",
        "    interruptFlag = false;",
        "    // Handle interrupt event",
        "    $0",
        "  }",
        "}",
        "",
        "void ${2:handleInterrupt}() {",
        "  interruptFlag = true;",
        "}"
      ]
    }
  ],
  "Data Structures": [
    {
      "name": "Circular Buffer",
      "prefix": "buffer",
      "description": "Circular buffer implementation",
      "body": [
        "const int BUFFER_SIZE = ${1:10};",
        "int buffer[BUFFER_SIZE];",
        "int head = 0;",
        "int tail = 0;",
        "int count = 0;",
        "",
        "bool bufferWrite(int value) {",
        "  if (count >= BUFFER_SIZE) return false;",
        "  buffer[head] = value;",
        "  head = (head + 1) % BUFFER_SIZE;",
        "  count++;",
        "  return true;",
        "}",
        "",
        "bool bufferRead(int* value) {",
        "  if (count == 0) return false;",
        "  *value = buffer[tail];",
        "  tail = (tail + 1) % BUFFER_SIZE;",
        "  count--;",
        "  return true;",
        "}",
        "",
        "void setup() {",
        "  Serial.begin(9600);",
        "}",
        "",
        "void loop() {",
        "  $0",
        "}"
      ]
    }
  ]
}
